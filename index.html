<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Музыка Апфс — Кишлак</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: #121212;
      color: #fff;
    }
    header {
      text-align: center;
      padding: 30px 15px 15px;
      background: #1e1e1e;
      box-shadow: 0 2px 10px rgba(255, 77, 184, 0.3);
    }
    header h1 {
      margin: 0;
      font-size: 2rem;
      color: #ff4db8;
    }
    nav {
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
      margin-top: 15px;
    }
    nav button {
      background: none;
      color: #ff87ce;
      border: none;
      padding: 10px 15px;
      cursor: pointer;
      font-weight: bold;
      border-bottom: 2px solid transparent;
    }
    nav button.active {
      color: #ff4db8;
      border-color: #ff4db8;
    }
    main {
      max-width: 960px;
      margin: auto;
      padding: 20px;
    }
    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    .track {
      background: #1e1e1e;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(255, 77, 184, 0.3);
    }
    .track h3 {
      margin: 0 0 10px;
      font-size: 1rem;
      color: #ff87ce;
    }
    .track audio {
      width: 100%;
      border-radius: 6px;
    }
    .download, .fav-btn {
      margin-top: 8px;
      display: inline-block;
      font-size: 0.9rem;
      color: #ff4db8;
      text-decoration: none;
      cursor: pointer;
      background: none;
      border: none;
    }
    .fav-btn {
      margin-left: 10px;
      color: #aaa;
    }
    .fav-btn.active {
      color: #ff4db8;
    }
    .hidden {
      display: none;
    }
    footer {
      text-align: center;
      margin: 40px 0;
      color: #888;
    }
    form input, form select, form textarea {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      background: #2a2a2a;
      border: none;
      border-radius: 10px;
      color: #fff;
      font-size: 1rem;
      box-sizing: border-box;
    }
    form button {
      background: #ff4db8;
      border: none;
      padding: 12px 20px;
      border-radius: 10px;
      color: #fff;
      font-weight: bold;
      cursor: pointer;
      font-size: 1rem;
    }
    /* Для вкладки История */
    #history {
      color: #ff4db8; /* розовый цвет */
      font-size: 1.2rem;
      text-align: center;
      padding: 30px;
      font-weight: bold;
    }

    /* Мобильная адаптация: 1 колонка */
    @media (max-width: 600px) {
      .grid {
        grid-template-columns: 1fr !important;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Музыка Апфс — Кишлак</h1>
    <nav>
      <button class="tab active" data-tab="all">Все треки</button>
      <button class="tab" data-tab="favorites">Избранное</button>
      <button class="tab" data-tab="list">Список</button>
      <button class="tab" data-tab="history">История</button>
      <button class="tab" data-tab="support">Поддержка</button>
    </nav>
  </header>
  <main>
    <section id="all" class="tab-content">
      <div class="grid" id="trackGrid"></div>
    </section>
    <section id="favorites" class="tab-content hidden">
      <div class="grid" id="favGrid"></div>
    </section>
    <section id="list" class="tab-content hidden">
      <h2>Список песен</h2>
      <ol id="trackList"></ol>
    </section>
    <section id="history" class="tab-content hidden">
      <p>Тут будет история Кишлака.</p>
    </section>
    <section id="support" class="tab-content hidden">
      <form action="https://formsubmit.co/apfs.kishlakk@gmail.com" method="POST" onsubmit="return validateSupportForm()">
        <input type="email" name="email" placeholder="Ваш Gmail" required />
        <select name="reason" required>
          <option value="">-- Причина --</option>
          <option value="Функция не работает">Функция не работает</option>
          <option value="Предложение">Предложение</option>
          <option value="Не хватает песни">Не хватает песни</option>
          <option value="Другое">Другое</option>
        </select>
        <textarea name="message" placeholder="Сообщение..." rows="5" required></textarea>
        <input type="hidden" name="_captcha" value="false" />
        <input type="hidden" name="_template" value="box" />
        <button type="submit">Отправить</button>
      </form>
    </section>
  </main>
  <footer>© 2025 Фанат Апфс — Все треки собраны с любовью</footer>

  <script>
    const tabs = document.querySelectorAll('.tab');
    const contents = document.querySelectorAll('.tab-content');

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        contents.forEach(c => c.classList.add('hidden'));
        document.getElementById(tab.dataset.tab).classList.remove('hidden');
      });
    });

    const titles = [
      "Alfa-Pvp",
      "Апноэ",
      "АФФ",
      "бесит бумага",
      "Вечер выпусников",
      "Давит весна",
      "Все будет нормально",
      "Все о чем мечтал",
      "Внутри",
      "Вы все отбросы",
      "Выдуманый друг",
      "Выплакаться",
      "Выпить или выпилиться",
      "Вьюга",
      "вьеби мне в голову",
      "Героиновый шейк",
      "Hyperjump",
      "Голая красивая",
      "Грязный Кайф",
      "Грязь",
      "Давай поправимся",
      "Движение",
      "Девочка",
      "Деньги суки ауе",
      "Дискотека 90-х",
      "Дома плохо",
      "Дорогу молодым",
      "Дрочу на твои фото",
      "Двинулься на тебе",
      "Ей",
      "Эхо-51",
      "Эмо",
      "Это второй",
      "ЗПНС",
      "Зажечь кровать",
      "Зачем я сегодня проснулься",
      "Девочка из питера",
      "идите нахуй",
      "Интро",
      "Канет вниз",
      "Картонка",
      "Кислота",
      "Клуб 27",
      "Кодировка",
      "Котик зайчик",
      "Кругосветка в рамках черепной коробки",
      "Ку ку",
      "Лава",
      "Лайтово",
      "Ложь, жизнь, Я",
      "Лучше",
      "Лягушачий блюз",
      "lv",
      "Ма я лаю",
      "Маленький бандит",
      "Мам я умираю",
      "Марина обойкина",
      "Метадон",
      "Мир для женщин",
      "Мнение",
      "Мне говорили",
      "Мне хуево",
      "Молча",
      "Музыка",
      "Музыки больше не будет",
      "Мультики",
      "Мы не одиноки",
      "Накуримся, напемся",
      "Нам пиздато",
      "Настя",
      "Нахуя",
      "Не в адеквате",
      "Не заберай меня домой",
      "Не любишь",
      "Ненавижу себя",
      "Нонсенс",
      "Один среди дорог",
      "Опинариум",
      "Опиаты",
      "Оргазм",
      "Открой мне двери",
      "Отмена",
      "Подъезд",
      "Покурил и упал в обморок",
      "Помню как вчера",
      "По старому",
      "Привидение",
      "Просто погавкай",
      "Прыгай с крыши",
      "Пьяные города",
      "Раздевайся",
      "Ржавый",
      "Робот",
      "Романтика",
      "Светлячок",
      "Сборник хуйни и картинки",
      "Сильнее соли",
      "Скорость",
      "Скорость света",
      "Слезы",
      "Слепые",
      "Собачий вальс",
      "Сонный паралич",
      "Спина старика",
      "Спокойной ночи, Максим",
      "Стану твоей проблемой",
      "Стиральная машина",
      "Stigmata",
      "Схавала Москва",
      "Схик2",
      "Там где нас нет",
      "Танци большого пса",
      "Твоя сука",
      "Тень",
      "Толер",
      "Тот самый",
      "Ты",
      "Тупые Предки",
      "Угу",
      "Упс",
      "Урка",
      "Утиль",
      "Фигридная сука",
      "Фильтр выкуриных сигарет",
      "Фобия",
      "Хаусхолд",
      "Хаунихау",
      "Ширево",
      "Шмон",
      "Я все",
      "Я впадаю в кому",
      "Я диско-шар",
      "Я заебал",
      "Я настоящий",
      "Я некрасивый",
      "Я немного пьян",
      "Я никогда не нюхал",
      "Я хочу убить себя",
      "Я уебываю в джаз",
      "Я умру в Североморске",
      "у-у-у",
      "первый милион",
      "да ну нах",
      "-5326364312",
      "$ALT $NUFF",
      "11:11",
      "15 припаратов",
      "21",
      "25",
      "105 оттенков автобуса",
      "Диссоциальное расстройство",
      "Выдумки",
      "закончим",
      "вьебы мне в четверг",
      "девушка моей мечты",
      "Не Отпускай",
      "Позерство",
      "bullterrier",
      "ты улыбаешься?",
      "Порно",
      "Я не верю в бога, я в себя не верю",
      "Таблетки",
      "Без ответа",
      "Пацанский Эмо Рэп",
      "Километры",
      "Болею тобой"
    ];

    const trackGrid = document.getElementById('trackGrid');
    const favGrid = document.getElementById('favGrid');
    const trackList = document.getElementById('trackList');
    let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');

    const tracksPerPage = 25;
    let currentTrackCount = tracksPerPage;

    function renderTracks() {
      trackGrid.innerHTML = '';
      favGrid.innerHTML = '';
      trackList.innerHTML = '';

      for(let i = 0; i < Math.min(currentTrackCount, titles.length); i++) {
        const id = i + 1;
        const title = titles[i];
        const track = document.createElement('div');
        track.className = 'track';

        const isFav = favorites.includes(id);

        track.innerHTML = `
          <h3>${id}. АПФС/КИШЛАК — ${title}</h3>
          <audio controls src="music/track${id}.mp3" data-id="${id}"></audio>
          <a class="download" href="music/track${id}.mp3" download>Скачать</a>
          <button class="fav-btn ${isFav ? 'active' : ''}" data-id="${id}">
            ${isFav ? '★ В избранном' : '☆ В избранное'}
          </button>
        `;

        trackGrid.appendChild(track);

        const li = document.createElement('li');
        li.textContent = title;
        trackList.appendChild(li);

        if (isFav) {
          const favTrack = track.cloneNode(true);
          favGrid.appendChild(favTrack);
        }
      }

      if(currentTrackCount < titles.length) {
        const loadMoreBtn = document.createElement('button');
        loadMoreBtn.textContent = 'Загрузить ещё';
        loadMoreBtn.style.display = 'block';
        loadMoreBtn.style.margin = '20px auto';
        loadMoreBtn.style.padding = '10px 20px';
        loadMoreBtn.style.fontSize = '1rem';
        loadMoreBtn.style.cursor = 'pointer';
        loadMoreBtn.style.background = '#ff4db8';
        loadMoreBtn.style.border = 'none';
        loadMoreBtn.style.borderRadius = '10px';
        loadMoreBtn.style.color = '#fff';
        loadMoreBtn.addEventListener('click', () => {
          currentTrackCount += tracksPerPage;
          renderTracks();
        });
        trackGrid.appendChild(loadMoreBtn);
      }

      document.querySelectorAll('.fav-btn').forEach(btn => {
        btn.removeEventListener('click', favClickHandler);
        btn.addEventListener('click', favClickHandler);
      });

      setupAudioEndEvents();
    }

    function favClickHandler(e) {
      const id = +e.currentTarget.dataset.id;
      if (favorites.includes(id)) {
        favorites = favorites.filter(f => f !== id);
      } else {
        favorites.push(id);
      }
      localStorage.setItem('favorites', JSON.stringify(favorites));
      renderTracks();
    }

    function setupAudioEndEvents() {
      const audios = document.querySelectorAll('#all audio');
      audios.forEach(audio => {
        audio.removeEventListener('ended', onTrackEnded);
        audio.addEventListener('ended', onTrackEnded);
      });
    }

    function onTrackEnded(e) {
      const currentAudio = e.target;
      const allAudios = Array.from(document.querySelectorAll('#all audio'));
      const currentIndex = allAudios.indexOf(currentAudio);
      if (currentIndex !== -1 && currentIndex < allAudios.length - 1) {
        const nextAudio = allAudios[currentIndex + 1];
        nextAudio.play();
      }
    }

    document.addEventListener('play', e => {
      if (e.target.tagName === 'AUDIO') {
        document.querySelectorAll('audio').forEach(audio => {
          if (audio !== e.target) audio.pause();
        });
      }
    }, true);

    function validateSupportForm() {
      const email = document.querySelector('input[type=email]').value.trim();
      if (!email.endsWith("@gmail.com")) {
        alert("Введите действительный Gmail адрес.");
        return false;
      }
      return true;
    }

    renderTracks();
  </script>
</body>
</html>
